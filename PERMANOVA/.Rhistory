geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = 'black', node = 156:410, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) #+
AS
###Same plot for Apodemus
AS <- ggtree(AS_tree, layout = 'circular') %<+%
AS_taxa +
geom_highlight(node = 421, fill = "#00ABA9", to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 446, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 453, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#76608A', node = 452, to.bottom = T) + #Deferribacterota
geom_highlight(fill = '#0050EF', node = 457, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#6A00FF', node = 563, to.bottom = T) + #Verruco
geom_highlight(fill = '#87794E', node = 562, to.bottom = T) + #Elusmo
geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 411:412, to.bottom = T)
AS
###Same plot for Apodemus
AS <- ggtree(AS_tree, layout = 'circular') %<+%
AS_taxa +
geom_highlight(node = 421, fill = "#00ABA9", to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 446, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 453, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#76608A', node = 452, to.bottom = T) + #Deferribacterota
geom_highlight(fill = '#0050EF', node = 457, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#6A00FF', node = 563, to.bottom = T) + #Verruco
geom_highlight(fill = '#87794E', node = 562, to.bottom = T) + #Elusmo
geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) + #Firmicutes
geom_highlight(fill = 'black', node = 411:412, to.bottom = T)
AS
###Same plot for Apodemus
AS <- ggtree(AS_tree, layout = 'circular') %<+%
AS_taxa +
geom_highlight(node = 421, fill = "#00ABA9", to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 446, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 453, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#76608A', node = 452, to.bottom = T) + #Deferribacterota
geom_highlight(fill = '#0050EF', node = 457, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#6A00FF', node = 563, to.bottom = T) + #Verruco
geom_highlight(fill = '#87794E', node = 562, to.bottom = T) + #Elusmo
geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 823, to.bottom = T)
AS
ggpubr::ggarrange(AS, CR, labels = c('A', 'B'))
CR <- ggtree(CR_tree, layout = 'fan') %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
ggpubr::ggarrange(AS, CR, labels = c('A', 'B'))
ggpubr::ggarrange(AS, CR, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggsave('./MAG_comparison.png')
ggpubr::ggarrange(AS, CR, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggsave('./figures/MAG_comparison.png')
ggsave('./figures/MAG_comparison.pdf')
ggsave('./figures/MAG_comparison.tiff', compression = 'lzw')
setwd('/home/adam/Documents/GitHub/Beho_2.0/All_hmscfiles/HMSC_split')
library(tidyverse)
library(ape)
library(phytools)
library(pheatmap)
library(ggtree)
library(Hmsc)
library(RColorBrewer)
library(wesanderson)
MM_treatment <- read.csv('./outputR/betapost_fortree2.csv', row.names = 1) %>%
t() %>%
as.data.frame()
MM_control <- read.csv('./outputR/betapost_fortree1.csv', row.names = 1) %>%
t() %>%
as.data.frame()
MM_tree <- read.tree('../../data/gtdbtk.backbone.bac120.classify.tree') %>%
keep.tip(rownames(MM_treatment)) %>%
force.ultrametric(MM_tree,method="extend")
metadata <- read.csv('../../data/metadata.csv')
taxa <- read.csv('../../data/gtdbtk_combined_summary.tsv', sep='\t') %>%
separate(classification, c('Domain', 'Phylum', 'c', 'o', 'f', 'g', 's'), ';') %>%
mutate(across(c('Domain', 'Phylum', 'c', 'o', 'f', 'g', 's'), ~gsub(".__", "", .)),
across(c('Domain', 'Phylum', 'c', 'o', 'f', 'g', 's'), ~gsub("_[A-B]", "", .))) %>%
.[.$user_genome %in% rownames(MM_treatment),] %>%
select(c(user_genome:s))
####Convert the phylo object to a hclust object
hc_MM <- as.hclust(MM_tree)
dend_MM <- as.dendrogram(hc_MM)
plot(dend_MM, horiz = T)
#####Order the dataframe to the phylo tree
ord.mat <- MM_treatment[MM_tree$tip,]
ord.mat_ctrl <- MM_control[MM_tree$tip,]
###Combine both heatmaps - alter names so that we can distinguish between controls and treatments
MM_treatment1 <- MM_treatment %>%
t() %>%
as.data.frame %>%
rownames_to_column('factors') %>%
mutate(factors = str_c('DE:', factors)) %>%
column_to_rownames('factors') %>%
t() %>%
as.data.frame()
MM_control1 <- MM_control %>%
t() %>%
as.data.frame %>%
rownames_to_column('factors') %>%
mutate(factors = str_c('NDE:', factors)) %>%
column_to_rownames('factors') %>%
t() %>%
as.data.frame() %>%
rownames_to_column('bins')
MM_combined <- MM_treatment1 %>%
rownames_to_column('bins') %>%
left_join(MM_control1, by = 'bins') %>%
column_to_rownames('bins') %>%
rename_all(~str_remove(., 'Disturbance')) %>%
mutate_all(as.character) %>%
rename_all(~str_remove(., 'DE:'))
###Create tree file
p <- ggtree(MM_tree) +
geom_tree()
p <- p %<+% taxa +
geom_tippoint(aes(color=Phylum), size=2) +
scale_colour_manual(values = wes_palette(n=6, name="IsleofDogs1"))
p
###create a dataframe in longformat for the heatmap
g <- gheatmap(p, MM_combined,
width = 3,
color = "white",
colnames = TRUE,
colnames_position = "bottom",
colnames_level = NULL,
font.size = 2.75,
hjust = 0.5,
colnames_angle = 90,
colnames_offset_y = -10,
colnames_offset_x = 0) +
scale_x_ggtree() +
ggtree::vexpand(.1, -1) +
scale_fill_manual(values = c('-1' = '#899DA4',
'0' = 'white',
'1' = '#C93312')) +
labs(fill='Statistical support') +
geom_vline(xintercept = 5.35) #+
annotate("text", x = 4, y = -10, label = "Disturbed")
g
ggsave('./figures/MM_mags.pdf', g, height = 7, width = 10)
ggsave('./figures/MM_mags.png', g, height = 7, width = 10)
###Create tree file
p <- ggtree(MM_tree) +
geom_tree()
p <- p %<+% taxa +
geom_tippoint(aes(color=Phylum), size=2) +
scale_colour_manual(values = wes_palette(n=6, name="IsleofDogs1"))
p
View(MM_combined)
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv')
View(CR_heatmap)
setwd('~/Documents/GitHub/Metgen_plasticityanalysis/Phylogenetic_tree/')
library(tidyverse)
library(ggtree)
library(ggpubr)
library(ape)
library(phytools)
library(ggtreeExtra)
library(viridis) #delete once found a better colour palette
metadata <- read.csv('../data/metadata.csv', header = T, row.names = 1)
CR_TPM <- read.csv('../data/TPM_CR.csv')
CR_tree <- read.tree(file='../data/gtdbtk.bac120.classify_CR.tree') %>%
keep.tip(CR_TPM$X) %>%
force.ultrametric(CR_tree,method="extend")
CR_taxa <- read.csv('../data/taxa.csv', sep=',', header=T, row.names=1) %>%
filter(str_detect(user_genome, '^bin_s')) %>%
column_to_rownames('user_genome') %>%
.[CR_TPM$X,] %>%
rownames_to_column('label') #necessary for the future joining
AS_TPM <- read.csv('../data/AS_TPM.csv') %>%
dplyr::select(!ends_with('FAST'))
AS_tree <- read.tree(file='../data/gtdbtk.bac120.classify_AS.tree') %>%
keep.tip(AS_TPM$X) %>%
force.ultrametric(AS_tree,method="extend")
AS_taxa <- read.csv('../data/taxa.csv', sep=',', header=T, row.names=1) %>%
filter(str_detect(user_genome, '^bin_m')) %>%
column_to_rownames('user_genome') %>%
.[AS_TPM$X,] %>%
rownames_to_column('label') #necessary for the future joining
CR <- ggtree(CR_tree, layout = 'fan') %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv', row.names = 1)
View(CR_heatmap)
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv', row.names = 1) %>%
.[tiplabels(CR_tree),]
setwd('~/Documents/GitHub/Metgen_plasticityanalysis/Phylogenetic_tree/')
library(tidyverse)
library(ggtree)
library(ggpubr)
library(ape)
library(phytools)
library(ggtreeExtra)
library(viridis) #delete once found a better colour palette
metadata <- read.csv('../data/metadata.csv', header = T, row.names = 1)
CR_TPM <- read.csv('../data/TPM_CR.csv')
CR_tree <- read.tree(file='../data/gtdbtk.bac120.classify_CR.tree') %>%
keep.tip(CR_TPM$X) %>%
force.ultrametric(CR_tree,method="extend")
CR_taxa <- read.csv('../data/taxa.csv', sep=',', header=T, row.names=1) %>%
filter(str_detect(user_genome, '^bin_s')) %>%
column_to_rownames('user_genome') %>%
.[CR_TPM$X,] %>%
rownames_to_column('label') #necessary for the future joining
AS_TPM <- read.csv('../data/AS_TPM.csv') %>%
dplyr::select(!ends_with('FAST'))
AS_tree <- read.tree(file='../data/gtdbtk.bac120.classify_AS.tree') %>%
keep.tip(AS_TPM$X) %>%
force.ultrametric(AS_tree,method="extend")
AS_taxa <- read.csv('../data/taxa.csv', sep=',', header=T, row.names=1) %>%
filter(str_detect(user_genome, '^bin_m')) %>%
column_to_rownames('user_genome') %>%
.[AS_TPM$X,] %>%
rownames_to_column('label') #necessary for the future joining
CR <- ggtree(CR_tree, layout = 'fan') %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv', row.names = 1) %>%
.[tiplabels(CR_tree),]
library(phytools)
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv', row.names = 1) %>%
.[CR_tree$tip.label,]
View(CR_heatmap)
CR_plot <- gheatmap(CR,
CR_heatmap)
CR_plot
CR_plot <- gheatmap(CR,
CR_heatmap,
low = 'blue',
high = 'red')
CR_plot
CR_plot <- gheatmap(CR,
CR_heatmap
) +
scale_fill_manual(values = c('-1' = '#899DA4',
'0' = 'white',
'1' = '#C93312')) +
CR_plot
CR_plot <- gheatmap(CR,
CR_heatmap
) +
scale_fill_manual(values = c('-1' = '#899DA4',
'0' = 'white',
'1' = '#C93312'))
CR_plot
??scale_fill_continuous
CR_plot <- gheatmap(CR,
CR_heatmap
) +
scale_fill_continuous(type = 'gradient')
CR_plot
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
AS_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_AS.csv', row.names = 1) %>%
.[AS_tree$tip.label,]
AS_plot <- gheatmap(AS,
AS_heatmap
) +
scale_fill_continuous(type = 'gradient')
###Same plot for Apodemus
AS <- ggtree(AS_tree, layout = 'circular') %<+%
AS_taxa +
geom_highlight(node = 421, fill = "#00ABA9", to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 446, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 453, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#76608A', node = 452, to.bottom = T) + #Deferribacterota
geom_highlight(fill = '#0050EF', node = 457, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#6A00FF', node = 563, to.bottom = T) + #Verruco
geom_highlight(fill = '#87794E', node = 562, to.bottom = T) + #Elusmo
geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 823, to.bottom = T)
AS
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
AS_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_AS.csv', row.names = 1) %>%
.[AS_tree$tip.label,]
AS_plot <- gheatmap(AS,
AS_heatmap
) +
scale_fill_continuous(type = 'gradient')
AS_plot
??gheatmap
??ggtree
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 90) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 10) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45, rotate_tree(45)) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) + #Actinobacter
rotate_tree(angle = 45)
??rotate_tree
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) + #Actinobacter
rotate_tree(., angle = 45)
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) + #Actinobacter
CR <- rotate_tree(CR, 45)
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR <- rotate_tree(CR, 45)
CR
CR <- rotate_tree(CR, 270)
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR <- rotate_tree(CR, 270)
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR <- rotate_tree(CR, 250)
CR
CR <- ggtree(CR_tree, layout = 'fan', open.angle = 45) %<+%
CR_taxa +
geom_highlight(node = 61, fill = "#00ABA9", type = 'rect', to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 60, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 75, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#0050EF', node = 77, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#D80073', node = 76, to.bottom = T) + #Chlamydiota
geom_highlight(fill = '#E51400', node = 78, to.bottom = T) + #Spirochaetota
geom_highlight(fill = '#AA00FF', node = 80, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 103, to.bottom = T) #Actinobacter
CR <- rotate_tree(CR, 290)
CR
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
CR_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_CR.csv', row.names = 1) %>%
.[CR_tree$tip.label,]
CR_plot <- gheatmap(CR,
CR_heatmap
) +
scale_fill_continuous(type = 'gradient')
CR_plot
###Same plot for Apodemus
AS <- ggtree(AS_tree, layout = 'fan', open.angle = 45) %<+%
AS_taxa +
geom_highlight(node = 421, fill = "#00ABA9", to.bottom = T) + #Proteo
geom_highlight(fill = '#825A2C', node = 446, to.bottom = T) + #Desulfo
geom_highlight(fill = '#F0A30A', node = 453, to.bottom = T) + #Campyllobacter
geom_highlight(fill = '#76608A', node = 452, to.bottom = T) + #Deferribacterota
geom_highlight(fill = '#0050EF', node = 457, to.bottom = T) + #Bacteroidota
geom_highlight(fill = '#6A00FF', node = 563, to.bottom = T) + #Verruco
geom_highlight(fill = '#87794E', node = 562, to.bottom = T) + #Elusmo
geom_highlight(fill = '#E3C800', node = 148, to.bottom = T) + #Fuso
geom_highlight(fill = '#A20025', node = 149, to.bottom = T) + #Patescibacteria
geom_highlight(fill = '#008A00', node = 564, to.bottom = T) + #Cyanobact
geom_highlight(fill = '#AA00FF', node = 569, to.bottom = T) + #Firmicutes
geom_highlight(fill = '#60A917', node = 823, to.bottom = T)
AS
AS <- rotate_tree(AS, 290)
AS
#######Combining heatmaps require the rownames of the heatmap to match the tipnames of the tree
AS_heatmap <- read.csv('../distillR/outputsR/distilled_table_functions_AS.csv', row.names = 1) %>%
.[AS_tree$tip.label,]
AS_plot <- gheatmap(AS,
AS_heatmap
) +
scale_fill_continuous(type = 'gradient')
AS_plot
ggpubr::ggarrange(AS, CR, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggpubr::ggarrange(AS_heatmap, CR_heatmap, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggpubr::ggarrange(AS_plot, CR_plot, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggpubr::ggarrange(AS_plot, CR_plot, labels = c('A: A.sylvaticus', 'B: C. russula'))
ggpubr::ggarrange(AS_plot, CR_plot, labels = c('A: A.sylvaticus', 'B: C. russula'
ggpubr::ggarrange(AS_plot, CR_plot, labels = c('A: A.sylvaticus', 'B: C. russula'),
ggpubr::ggarrange(AS_plot,
CR_plot,
labels = c('A: A.sylvaticus', 'B: C. russula'),
nrow = 2,
common.legend = T)
ggpubr::ggarrange(AS_plot,
CR_plot,
labels = c('A: A.sylvaticus', 'B: C. russula'),
common.legend = T,
legend.position = 'bottom')
